<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ethos Farcaster Reader</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-50">
    <div class="min-h-screen">
        <header class="bg-purple-600 text-white shadow-lg">
            <div class="container mx-auto px-4 py-6">
                <h1 class="text-3xl font-bold">üîê Ethos Farcaster Reader</h1>
                <p class="text-purple-200 mt-2">Trust-ranked Farcaster channels</p>
            </div>
        </header>

        <div class="container mx-auto px-4 py-6">
            <div class="bg-white rounded-lg shadow p-6 mb-6">
                <label class="block text-sm font-medium text-gray-700 mb-2">Channel</label>
                <input 
                    type="text" 
                    id="channelInput" 
                    value="crypto" 
                    class="w-full px-4 py-2 border rounded-lg mb-4"
                >
                <button 
                    id="loadBtn" 
                    class="w-full bg-purple-600 text-white px-6 py-3 rounded-lg font-semibold hover:bg-purple-700"
                >
                    Load Casts
                </button>
            </div>

            <div id="loading" class="text-center py-12 hidden">
                <p class="text-gray-600">Loading...</p>
            </div>

            <div id="castsContainer"></div>
        </div>
    </div>

    <script>
        document.getElementById('loadBtn').addEventListener('click', function() {
            var channel = document.getElementById('channelInput').value || 'crypto';
            var loading = document.getElementById('loading');
            var container = document.getElementById('castsContainer');
            
            loading.classList.remove('hidden');
            container.innerHTML = '';
            
            fetch('/api/channel?channel=' + channel)
                .then(function(r) { return r.json(); })
                .then(function(data) {
                    loading.classList.add('hidden');
                    
                    if (data.success && data.casts) {
                        var html = '';
                        for (var i = 0; i < data.casts.length; i++) {
                            var cast = data.casts[i];
                            var color = cast.trustRank >= 70 ? 'green' : (cast.trustRank >= 40 ? 'yellow' : 'red');
                            
                            html += '<div class="bg-white rounded-lg shadow p-6 mb-4">';
                            html += '<div class="flex justify-between mb-2">';
                            html += '<strong>' + cast.author.displayName + '</strong>';
                            html += '<span class="text-' + color + '-600 font-bold">Trust: ' + cast.trustRank + '</span>';
                            html += '</div>';
                            html += '<p class="text-gray-800">' + cast.text + '</p>';
                            html += '<div class="text-sm text-gray-600 mt-2">';
                            html += '‚ù§Ô∏è ' + cast.reactions.likes + ' | üîÑ ' + cast.reactions.recasts;
                            html += '</div>';
                            html += '</div>';
                        }
                        container.innerHTML = html;
                    } else {
                        container.innerHTML = '<div class="bg-red-100 p-4 rounded">Error loading casts</div>';
                    }
                })
                .catch(function(err) {
                    loading.classList.add('hidden');
                    container.innerHTML = '<div class="bg-red-100 p-4 rounded">Error: ' + err.message + '</div>';
                });
        });
        
        // Auto-load on start
        document.getElementById('loadBtn').click();
    </script>
</body>
</html>
